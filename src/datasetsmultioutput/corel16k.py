from river.datasets import base
import stream


class Corel16k(base.RemoteDataset):
    """
    It is derived from the popular benchmark dataset ECCV 2002 by eliminating less frequently appeared labels.

    Kobus Barnard, Pinar Duygulu, Nando de Freitas, David Forsyth, David Blei, and Michael I. Jordan. Matching Words and Pictures. Journal of Machine Learning Research. 2003. Vol 3, pp 1107-1135.
    """
    def __init__(self):
        super().__init__(
            task=base.MO_BINARY_CLF,
            n_samples=13766,
            n_features=500,
            n_outputs=153,
            url="http://www.uco.es/grupos/kdis/MLLResources/ucobigfiles/Datasets/Full/Corel16k001_Meka.zip",
            unpack=True,
            filename="Corel16k001.arff",
            size=17_995_960,
        )

    def _iter(self):
        return stream.iter_arff(
            self.path,
            sparse=False,
            target=[
                "animal",
                "arch",
                "architecture",
                "art",
                "background",
                "bay",
                "beach",
                "bears",
                "birds",
                "black",
                "boats",
                "branch",
                "branches",
                "bridge",
                "buildings",
                "cactus",
                "candy",
                "car",
                "castle",
                "cat",
                "church",
                "city",
                "cliff",
                "close-up",
                "closeup",
                "clouds",
                "coast",
                "columns",
                "coral",
                "costume",
                "cougar",
                "courtyard",
                "crystal",
                "desert",
                "designs",
                "detail",
                "display",
                "dog",
                "doors",
                "dunes",
                "elephants",
                "entrance",
                "f-16",
                "face",
                "fence",
                "field",
                "fish",
                "flight",
                "flowers",
                "food",
                "forest",
                "formation",
                "formula",
                "fungus",
                "gardens",
                "grass",
                "ground",
                "gun",
                "harbor",
                "hats",
                "hawk",
                "head",
                "helicopter",
                "herd",
                "hills",
                "horizon",
                "horse",
                "house",
                "hunter",
                "ice",
                "insect",
                "island",
                "jet",
                "kauai",
                "leaf",
                "leaves",
                "light",
                "lion",
                "lizard",
                "mane",
                "market",
                "mountain",
                "museum",
                "mushrooms",
                "nest",
                "night",
                "ocean",
                "outside",
                "owl",
                "paintings",
                "palace",
                "pattern",
                "people",
                "perch",
                "pillars",
                "plane",
                "plants",
                "polar",
                "prototype",
                "pumpkins",
                "pyramid",
                "reefs",
                "reflection",
                "restaurant",
                "river",
                "road",
                "rock",
                "roofs",
                "ruins",
                "runway",
                "saguaro",
                "sand",
                "scotland",
                "sculpture",
                "sea",
                "seals",
                "shadows",
                "ships",
                "shop",
                "shore",
                "shrine",
                "skis",
                "sky",
                "smoke",
                "snake",
                "snow",
                "statues",
                "stone",
                "street",
                "sun",
                "sunset",
                "tables",
                "temple",
                "textile",
                "texture",
                "tower",
                "town",
                "tracks",
                "tree",
                "trunk",
                "turn",
                "valley",
                "vegetables",
                "village",
                "walls",
                "water",
                "waves",
                "wildlife",
                "windows",
                "wolf",
                "woman",
                "woods",
                "zebra",
            ],
        )
