from river import stream
from river.datasets import base


class Langlog(base.RemoteDataset):
    """
    It was compiled from the Language Log Forum, which discussed various topics relating to language, and 75 topics represents the label space.

    Jesse Read. Scalable multi-label classification. PhD Thesis, University of Waikato, 2010.
    """
    def __init__(self):
        super().__init__(
            task=base.MO_BINARY_CLF,
            n_samples=1460,
            n_features=1004,
            n_outputs=75,
            url="http://www.uco.es/grupos/kdis/MLLResources/ucobigfiles/Datasets/Full/Langlog_Meka.zip",
            unpack=True,
            filename="Langlog.arff",
            size=1_693_749,
        )
    
    def _iter(self):
        return stream.iter_arff(
            self.path,
            sparse=True,
            target=[
                "Errors",
                "Humor",
                "Speech_acts",
                "Prescriptivist_Poppycock",
                "Phonetics_and_phonology",
                "Punctuation",
                "Administration",
                "Language_and_culture",
                "This_blogging_life",
                "Ignorance_of_Linguistics",
                "HLT",
                "Announcements",
                "Syntax",
                "coordination",
                "Language_and_the_media",
                "Uncategorized",
                "Animal_communication",
                "Linguification",
                "Language_and_advertising",
                "Quizzes",
                "Snowclones",
                "Fieldwork",
                "negation",
                "Variation",
                "Language_and_sports",
                "prepositions",
                "Obituaries",
                "Language_planning",
                "who_whom",
                "WTF",
                "Discrimination",
                "Language_teaching_and_learning",
                "Linguistics_in_the_comics",
                "Ethics",
                "Language_in_the_movies",
                "The_academic_scene",
                "Pragmatics",
                "Semantics",
                "Linguistic_history",
                "Awesomeness",
                "Usage_advice",
                "ambiguity",
                "Idioms",
                "Language_play",
                "Words_words_words",
                "agreement",
                "The_language_of_science",
                "Language_and_technology",
                "Gift_ideas",
                "Taboo_vocabulary",
                "relative_clauses",
                "Language_and_the_law",
                "Lost_in_Translation",
                "Writing",
                "Linguistics_in_the_news",
                "Eggcorns",
                "Endangered_languages",
                "Language_on_the_internets",
                "Links",
                "Peeving",
                "Orthography",
                "Resources",
                "Names",
                "Changing_Times",
                "Language_and_politics",
                "Psychology_of_language",
                "Books",
                "Research_tools",
                "Writing_Systems",
                "Language_change",
                "Style_and_register",
                "Morphology",
                "passives",
                "singular__they",
                "Computational_Linguistics",
            ],
        )